# 语音后台服务器配置文件 - 流式大模型配置

# 服务器配置
server:
  ip: '0.0.0.0'
  port: 8000 # WebSocket端口
  http_port: 8003 # HTTP API端口
  auth_key: 'your-auth-key-change-this' # JWT认证密钥
  vision_explain: '' # 视觉解释接口URL

# 管理API配置（可选，用于集中配置管理）
manager-api:
  url: '' # 管理API地址，如 http://localhost:8002
  secret: '' # 管理API密钥

# MCP配置
mcp_endpoint: 'ws://localhost:8000/mcp/'

# 日志配置
log:
  level: 'info' # debug, info, warn, error
  log_dir: 'tmp'

# 选择的模块（流式大模型推荐配置）
selected_module:
  ASR: 'xunfei_stream' # 讯飞流式ASR
  LLM: 'qwen_flash' # 阿里百炼 qwen-flash
  VLLM: 'qwen_vl' # 阿里百炼 qwen2.5-vl-3b-instructh
  TTS: 'huoshan_stream' # 火山引擎双流式TTS
  VAD: 'silero'
  Intent: 'function_call' # 函数调用意图识别
  Memory: 'mem_local_short' # 本地短期记忆

# ASR配置 - 讯飞实时语音转写大模型
ASR:
  xunfei_stream:
    app_id: '0b40aea9' # 讯飞应用ID
    access_key_id: 'f527bcba1a7fe10d2ed5ee00c5a356ac' # 讯飞AccessKeyId
    access_key_secret: 'YjRkZDhhMDAxYzAzYjA0OWU3ZmUxNDYx' # 讯飞AccessKeySecret
    api_url: 'wss://office-api-ast-dx.iflyaisol.com/ast/communicate/v1' # 实时语音转写大模型接口
    lang: 'autodialect' # 语言：autodialect(中英+202种方言), autominor(37种语种)
    audio_encode: 'pcm_s16le' # 音频编码：pcm_s16le, speex-7, speex-10, opus-wb
    samplerate: 16000 # 采样率：16000, 8000
    role_type: 0 # 说话人分离：0-关闭, 2-开启实时角色分离
    pd: '' # 领域个性化：court, finance, medical, tech, sport, edu等
    output_dir: 'tmp/asr'

# LLM配置 - 阿里百炼 qwen-flash
LLM:
  qwen_flash:
    api_key: 'sk-e33de26ce63d4cf7aae73358d1a8af51' # 阿里云百炼API密钥
    base_url: 'https://dashscope.aliyuncs.com/compatible-mode/v1'
    model: 'qwen-plus' # qwen-plus, qwen-max, qwen-turbo
    temperature: 0.7
    max_tokens: 2000
    top_p: 0.8
    enable_search: false # 是否启用互联网搜索

# VLLM配置 - 阿里百炼视觉大模型
VLLM:
  qwen_vl:
    api_key: 'sk-e33de26ce63d4cf7aae73358d1a8af51'
    model: 'qwen-vl-max' # qwen-vl-max, qwen-vl-plus, qwen-vl-ocr
    temperature: 0.7
    max_tokens: 1500

# TTS配置 - 火山引擎大模型语音合成（双向流式）
TTS:
  huoshan_stream:
    appid: '6255418053' # 火山引擎应用ID
    access_token: '0fL5wK2g8SqWWjWw6A43PadF_nzJPrqn' # 火山引擎访问令牌
    resource_id: 'hd1Qq70WF4yGSFMSfEMwFdlq0U1OAn8l' # 资源ID
    cluster: 'volcano_tts'
    ws_url: 'wss://openspeech.bytedance.com/api/v1/tts/ws_binary' # 大模型双流式API
    speaker: 'zh_female_qingxin' # 音色ID，支持325+音色
    speech_rate: 1.0 # 语速比例：0.5~2.0
    loudness_rate: 1.0 # 音量比例：0.5~2.0
    pitch: 1.0 # 音调比例：0.5~2.0
    sample_rate: 24000 # 采样率：48000, 24000, 16000, 8000
    audio_format: 'pcm' # 音频格式：pcm, ogg_opus, mp3
    output_dir: 'tmp/tts'

# VAD配置（智能语音活动检测）
VAD:
  silero:
    threshold: 0.3 # 检测阈值（0-1）
    sample_rate: 16000
    min_speech_duration: 250 # 最小语音持续时间（ms）
    max_silence_duration: 500 # 最大静默持续时间（ms）

# 意图识别配置 - 函数调用
Intent:
  function_call:
    enabled: true
    provider: 'qwen_flash' # 使用qwen-flash进行意图识别
    functions: # 可用函数列表
      - name: 'get_weather'
        description: '获取指定城市的天气信息'
        parameters:
          type: 'object'
          properties:
            city:
              type: 'string'
              description: '城市名称'
          required: ['city']

# 记忆模块配置 - 本地短期记忆
Memory:
  mem_local_short:
    enabled: true
    max_history: 10 # 最大保留对话轮数
    max_tokens: 4000 # 最大token数
    summary_threshold: 8 # 超过此轮数后进行摘要
