# ============================================================
# Elysia AI Server 环境变量配置 - 默认配置模板
# 等价于 Python 版本的 server/config.yaml
# 用户自定义配置请使用 .env.production 文件 (等价于 server/data/.config.yaml)
# ============================================================

# ============================================================
# 服务器配置 (server)
# ============================================================
SERVER_IP=0.0.0.0
SERVER_PORT=30000
SERVER_HTTP_PORT=30003
# 这个 websocket 配置是指 ota 接口向设备发送的 websocket 地址
# 当你使用 docker 部署时，将 websocket 设置成局域网地址
# 如果你使用公网部署时，将 websocket 设置成公网地址
SERVER_WEBSOCKET=ws://你的ip或者域名:端口号/xiaozhi/v1/
# 视觉分析接口地址
SERVER_VISION_EXPLAIN=http://你的ip或者域名:端口号/mcp/vision/explain
# OTA返回信息时区偏移量
SERVER_TIMEZONE_OFFSET=+8
# 认证配置
SERVER_AUTH_ENABLED=false
# 白名单设备ID列表（逗号分隔）
SERVER_AUTH_ALLOWED_DEVICES=
# 鉴权密钥
SERVER_AUTH_KEY=

# MQTT网关配置
MQTT_GATEWAY=
MQTT_SIGNATURE_KEY=
# UDP网关配置
UDP_GATEWAY=

# ============================================================
# 日志配置 (log)
# ============================================================
# 日志等级：DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO
LOG_DIR=tmp
LOG_FILE=server.log
DATA_DIR=data

# ============================================================
# 基础配置
# ============================================================
# 使用完声音文件后删除文件
DELETE_AUDIO=true
# 没有语音输入多久后断开连接(秒)
CLOSE_CONNECTION_NO_VOICE_TIME=120
# TTS请求超时时间(秒)
TTS_TIMEOUT=10
# 开启唤醒词加速
ENABLE_WAKEUP_WORDS_RESPONSE_CACHE=true
# 开场是否回复唤醒词
ENABLE_GREETING=true
# 说完话是否开启提示音
ENABLE_STOP_TTS_NOTIFY=false
# 是否启用WebSocket心跳保活机制
ENABLE_WEBSOCKET_PING=false
# TTS音频发送延迟配置 (0: 使用精确时间控制)
TTS_AUDIO_SEND_DELAY=0

# ============================================================
# 模块选择 (selected_module)
# ============================================================
# 语音活动检测模块
SELECTED_VAD=SileroVAD
# 语音识别模块
SELECTED_ASR=FunASR
# 大语言模型
SELECTED_LLM=ChatGLMLLM
# 视觉语言大模型
SELECTED_VLLM=ChatGLMVLLM
# 语音合成模块
SELECTED_TTS=EdgeTTS
# 记忆模块 (nomem/mem0ai/mem_local_short)
SELECTED_MEMORY=nomem
# 意图识别模块 (nointent/intent_llm/function_call)
SELECTED_INTENT=function_call

# ============================================================
# VAD 配置 - Silero 语音活动检测
# ============================================================
VAD_TYPE=silero
VAD_THRESHOLD=0.5
VAD_THRESHOLD_LOW=0.3
VAD_MODEL_DIR=models/snakers4_silero-vad
# 如果说话停顿比较长，可以把这个值设置大一些
VAD_MIN_SILENCE_DURATION_MS=200

# ============================================================
# ASR 配置 - FunASR 本地模型 (默认)
# ============================================================
ASR_FUNASR_TYPE=fun_local
ASR_FUNASR_MODEL_DIR=models/SenseVoiceSmall
ASR_FUNASR_OUTPUT_DIR=tmp/

# ASR - FunASR Server (独立部署)
ASR_FUNASRSERVER_TYPE=fun_server
ASR_FUNASRSERVER_HOST=127.0.0.1
ASR_FUNASRSERVER_PORT=10096
ASR_FUNASRSERVER_IS_SSL=true
ASR_FUNASRSERVER_API_KEY=none
ASR_FUNASRSERVER_OUTPUT_DIR=tmp/

# ASR - Doubao (火山引擎按次收费)
# https://console.volcengine.com/speech/app
ASR_DOUBAO_TYPE=doubao
ASR_DOUBAO_APPID=你的火山引擎语音合成服务appid
ASR_DOUBAO_ACCESS_TOKEN=你的火山引擎语音合成服务access_token
ASR_DOUBAO_CLUSTER=volcengine_input_common
ASR_DOUBAO_OUTPUT_DIR=tmp/

# ASR - DoubaoStream (火山引擎按时收费，大模型技术，效果更好)
# https://console.volcengine.com/speech/service/10011
ASR_DOUBAOSTREAM_TYPE=doubao_stream
ASR_DOUBAOSTREAM_APPID=你的火山引擎语音合成服务appid
ASR_DOUBAOSTREAM_ACCESS_TOKEN=你的火山引擎语音合成服务access_token
ASR_DOUBAOSTREAM_CLUSTER=volcengine_input_common
# 流式模式: bigmodel, bigmodel_async(推荐), bigmodel_nostream
ASR_DOUBAOSTREAM_STREAM_MODE=bigmodel_async
# Resource ID:
# 1.0小时版: volc.bigasr.sauc.duration
# 1.0并发版: volc.bigasr.sauc.concurrent
# 2.0小时版: volc.seedasr.sauc.duration (推荐)
# 2.0并发版: volc.seedasr.sauc.concurrent
ASR_DOUBAOSTREAM_RESOURCE_ID=volc.seedasr.sauc.duration
ASR_DOUBAOSTREAM_END_WINDOW_SIZE=200
ASR_DOUBAOSTREAM_OUTPUT_DIR=tmp/

# ============================================================
# LLM 配置
# ============================================================
# LLM - 阿里百炼 (AliLLM)
# https://bailian.console.aliyun.com/?apiKey=1#/api-key
LLM_ALI_TYPE=openai
LLM_ALI_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
LLM_ALI_MODEL=qwen-turbo
LLM_ALI_API_KEY=你的阿里百炼api_key
LLM_ALI_TEMPERATURE=0.7
LLM_ALI_MAX_TOKENS=500
LLM_ALI_TOP_P=1
LLM_ALI_FREQUENCY_PENALTY=0

# LLM - Doubao (火山方舟)
# https://console.volcengine.com/ark/region:ark+cn-beijing/openManagement
LLM_DOUBAO_TYPE=openai
LLM_DOUBAO_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
LLM_DOUBAO_MODEL=doubao-1-5-pro-32k-250115
LLM_DOUBAO_API_KEY=你的doubao_api_key

# LLM - DeepSeek
# https://platform.deepseek.com/
LLM_DEEPSEEK_TYPE=openai
LLM_DEEPSEEK_BASE_URL=https://api.deepseek.com
LLM_DEEPSEEK_MODEL=deepseek-chat
LLM_DEEPSEEK_API_KEY=你的deepseek_api_key

# LLM - ChatGLM (免费)
# https://bigmodel.cn/usercenter/proj-mgmt/apikeys
LLM_CHATGLM_TYPE=openai
LLM_CHATGLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
LLM_CHATGLM_MODEL=glm-4-flash
LLM_CHATGLM_API_KEY=你的chatglm_api_key

# LLM - Ollama (本地)
LLM_OLLAMA_TYPE=ollama
LLM_OLLAMA_BASE_URL=http://localhost:11434
LLM_OLLAMA_MODEL=qwen2.5

# LLM - OpenAI
LLM_OPENAI_TYPE=openai
LLM_OPENAI_BASE_URL=https://api.openai.com/v1
LLM_OPENAI_MODEL=gpt-4-turbo-preview
LLM_OPENAI_API_KEY=你的openai_api_key

# LLM - Gemini
# https://aistudio.google.com/apikey
LLM_GEMINI_TYPE=gemini
LLM_GEMINI_MODEL=gemini-2.0-flash
LLM_GEMINI_API_KEY=你的gemini_api_key

# LLM - Claude
LLM_CLAUDE_TYPE=claude
LLM_CLAUDE_MODEL=claude-3-opus-20240229
LLM_CLAUDE_API_KEY=你的anthropic_api_key

# LLM - Groq
LLM_GROQ_TYPE=groq
LLM_GROQ_MODEL=mixtral-8x7b-32768
LLM_GROQ_API_KEY=你的groq_api_key

# ============================================================
# VLLM 配置 (视觉语言大模型)
# ============================================================
# VLLM - ChatGLM (免费)
# https://bigmodel.cn/usercenter/proj-mgmt/apikeys
VLLM_CHATGLM_TYPE=openai
VLLM_CHATGLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
VLLM_CHATGLM_MODEL=glm-4v-flash
VLLM_CHATGLM_API_KEY=你的chatglm_api_key

# VLLM - 讯飞星火
VLLM_XUNFEI_TYPE=openai
VLLM_XUNFEI_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
VLLM_XUNFEI_MODEL=lite
VLLM_XUNFEI_API_KEY=你的xunfei_api_key

# ============================================================
# TTS 配置
# ============================================================
# TTS - Edge (默认，免费)
TTS_EDGE_TYPE=edge
TTS_EDGE_VOICE=zh-CN-XiaoxiaoNeural
TTS_EDGE_OUTPUT_DIR=tmp/

# TTS - Doubao (火山引擎)
TTS_DOUBAO_TYPE=doubao
TTS_DOUBAO_API_URL=https://openspeech.bytedance.com/api/v1/tts
TTS_DOUBAO_APPID=你的火山引擎appid
TTS_DOUBAO_ACCESS_TOKEN=你的火山引擎access_token
TTS_DOUBAO_CLUSTER=volcano_tts
TTS_DOUBAO_VOICE=BV001_streaming
TTS_DOUBAO_SPEED_RATIO=1.0
TTS_DOUBAO_VOLUME_RATIO=1.0
TTS_DOUBAO_PITCH_RATIO=1.0
TTS_DOUBAO_OUTPUT_DIR=tmp/

# TTS - 火山双向流式 (推荐)
# https://console.volcengine.com/speech/service/10007
TTS_HUOSHAN_STREAM_TYPE=huoshan_double_stream
TTS_HUOSHAN_STREAM_WS_URL=wss://openspeech.bytedance.com/api/v3/tts/bidirection
TTS_HUOSHAN_STREAM_APPID=你的火山引擎appid
TTS_HUOSHAN_STREAM_ACCESS_TOKEN=你的火山引擎access_token
TTS_HUOSHAN_STREAM_RESOURCE_ID=volc.service_type.10029
TTS_HUOSHAN_STREAM_SPEAKER=zh_female_wanwanxiaohe_moon_bigtts
TTS_HUOSHAN_STREAM_ENABLE_WS_REUSE=true
TTS_HUOSHAN_STREAM_SPEECH_RATE=0
TTS_HUOSHAN_STREAM_LOUDNESS_RATE=0
TTS_HUOSHAN_STREAM_PITCH=0

# TTS - OpenAI
TTS_OPENAI_TYPE=openai
TTS_OPENAI_API_URL=https://api.openai.com/v1/audio/speech
TTS_OPENAI_API_KEY=你的openai_api_key
TTS_OPENAI_MODEL=tts-1
TTS_OPENAI_VOICE=alloy
TTS_OPENAI_SPEED=1
TTS_OPENAI_OUTPUT_DIR=tmp/

# ============================================================
# Memory 配置
# ============================================================
# Memory - mem0ai (在线记忆，每月1000次免费)
# https://app.mem0.ai/dashboard/api-keys
MEMORY_MEM0AI_TYPE=mem0ai
MEMORY_MEM0AI_API_KEY=你的mem0ai_api_key

# Memory - 本地短期记忆
MEMORY_LOCAL_TYPE=mem_local_short
MEMORY_LOCAL_LLM=ChatGLMLLM

# ============================================================
# Intent 配置
# ============================================================
# Intent - function_call (需要LLM支持function_call)
INTENT_FUNCTION_CALL_TYPE=function_call
# 可用函数列表（逗号分隔）
INTENT_FUNCTION_CALL_FUNCTIONS=change_role,get_weather,get_news_from_newsnow,play_music

# Intent - intent_llm (通用性强，增加处理时间)
INTENT_LLM_TYPE=intent_llm
INTENT_LLM_LLM=ChatGLMLLM
INTENT_LLM_FUNCTIONS=get_weather,get_news_from_newsnow,play_music

# ============================================================
# 插件配置 (plugins)
# ============================================================
# 和风天气插件
# 申请地址：https://console.qweather.com/#/apps/create-key/over
# 每天有1000次免费调用
PLUGIN_WEATHER_API_HOST=mj7p3y7naa.re.qweatherapi.com
PLUGIN_WEATHER_API_KEY=a861d0d5e7bf4ee1a83d9a9e4f96d4da
PLUGIN_WEATHER_DEFAULT_LOCATION=广州

# 新闻插件 - chinanews
PLUGIN_NEWS_CHINANEWS_DEFAULT_RSS_URL=https://www.chinanews.com.cn/rss/society.xml

# 新闻插件 - newsnow
PLUGIN_NEWS_NEWSNOW_URL=https://newsnow.busiyi.world/api/s?id=
PLUGIN_NEWS_NEWSNOW_SOURCES=澎湃新闻;百度热搜;财联社

# Home Assistant 插件
PLUGIN_HASS_BASE_URL=http://homeassistant.local:8123
PLUGIN_HASS_API_KEY=你的home_assistant_api_key

# 音乐播放插件
PLUGIN_MUSIC_DIR=./music
PLUGIN_MUSIC_EXT=.mp3,.wav,.p3
PLUGIN_MUSIC_REFRESH_TIME=300

# RAGFlow 知识库插件
PLUGIN_RAGFLOW_DESCRIPTION=当用户问xxx时，调用本方法
PLUGIN_RAGFLOW_BASE_URL=http://192.168.0.8
PLUGIN_RAGFLOW_API_KEY=ragflow-xxx
PLUGIN_RAGFLOW_DATASET_IDS=123456789

# ============================================================
# 声纹识别配置 (voiceprint)
# ============================================================
VOICEPRINT_URL=
VOICEPRINT_SIMILARITY_THRESHOLD=0.4
# 说话人配置（逗号分隔的 speaker_id,名称,描述）
VOICEPRINT_SPEAKERS=test1,张三,张三是一个程序员;test2,李四,李四是一个产品经理

# ============================================================
# MCP 配置
# ============================================================
# MCP接入点地址
# 地址格式：ws://你的mcp接入点ip或者域名:端口号/mcp/?token=你的token
MCP_ENDPOINT=你的接入点_websocket地址

# ============================================================
# Manager API 配置 (智控台)
# ============================================================
MANAGER_API_URL=
MANAGER_API_SECRET=

# ============================================================
# 上下文源配置 (context_providers)
# ============================================================
CONTEXT_PROVIDER_URL=
CONTEXT_PROVIDER_AUTH=

# ============================================================
# 系统提示词
# ============================================================
PROMPT_TEMPLATE=agent-base-prompt.txt

# ============================================================
# Node 环境
# ============================================================
NODE_ENV=development

